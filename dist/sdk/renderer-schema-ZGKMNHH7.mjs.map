{"version":3,"sources":["../../src/state-machine/dispatch/renderer-schema.ts"],"sourcesContent":["import { logger } from '../../logger';\n\n/**\n * Load a built-in JSON Schema for a named renderer (e.g., \"code-review\",\n * \"issue-assistant\", \"overview\", \"plain\"). Returns undefined when not found.\n *\n * Mirrors template resolution in template-renderer.ts, but targets schema.json.\n */\nexport async function loadRendererSchema(name: string): Promise<any | undefined> {\n  try {\n    const fs = await import('fs/promises');\n    const path = await import('path');\n    const sanitized = String(name).replace(/[^a-zA-Z0-9-]/g, '');\n    if (!sanitized) return undefined;\n\n    const candidates = [\n      // When running from dist\n      path.join(__dirname, '..', '..', 'output', sanitized, 'schema.json'),\n      // When running from a checkout with output/ folder copied to CWD\n      path.join(process.cwd(), 'output', sanitized, 'schema.json'),\n    ];\n\n    for (const p of candidates) {\n      try {\n        const raw = await fs.readFile(p, 'utf-8');\n        return JSON.parse(raw);\n      } catch {}\n    }\n  } catch (e) {\n    try {\n      logger.warn(`[schema-loader] Failed to load renderer schema '${name}': ${String(e)}`);\n    } catch {}\n  }\n  return undefined;\n}\n"],"mappings":";;;;;;;;;AAQA,eAAsB,mBAAmB,MAAwC;AAC/E,MAAI;AACF,UAAM,KAAK,MAAM,OAAO,aAAa;AACrC,UAAM,OAAO,MAAM,OAAO,MAAM;AAChC,UAAM,YAAY,OAAO,IAAI,EAAE,QAAQ,kBAAkB,EAAE;AAC3D,QAAI,CAAC,UAAW,QAAO;AAEvB,UAAM,aAAa;AAAA;AAAA,MAEjB,KAAK,KAAK,WAAW,MAAM,MAAM,UAAU,WAAW,aAAa;AAAA;AAAA,MAEnE,KAAK,KAAK,QAAQ,IAAI,GAAG,UAAU,WAAW,aAAa;AAAA,IAC7D;AAEA,eAAW,KAAK,YAAY;AAC1B,UAAI;AACF,cAAM,MAAM,MAAM,GAAG,SAAS,GAAG,OAAO;AACxC,eAAO,KAAK,MAAM,GAAG;AAAA,MACvB,QAAQ;AAAA,MAAC;AAAA,IACX;AAAA,EACF,SAAS,GAAG;AACV,QAAI;AACF,aAAO,KAAK,mDAAmD,IAAI,MAAM,OAAO,CAAC,CAAC,EAAE;AAAA,IACtF,QAAQ;AAAA,IAAC;AAAA,EACX;AACA,SAAO;AACT;AAlCA;AAAA;AAAA;AAAA;AAAA;","names":[]}