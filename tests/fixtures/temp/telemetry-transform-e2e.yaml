version: '1.0'
checks:
  build-data:
    type: command
    exec: >-
      node -e
      "console.log(JSON.stringify({group:{items:[{id:'A',n:1},{id:'B',n:2}]}}))"
    transform: '{{ output.group.items | json }}'
    forEach: true
    group: transform
  process-item:
    type: command
    exec: >-
      node -e "console.log('PROC:'+JSON.stringify({id:'{{
      outputs['build-data'].id }}',n:{{ outputs['build-data'].n }} }))"
    depends_on:
      - build-data
    group: transform
  emit-files:
    type: command
    exec: |-
      node -e "console.log('file1.js
      file2.js')"
    transform: |-
      {{ output | split: "
      " | json }}
    forEach: true
    group: files
  analyze-file:
    type: command
    exec: node -e "console.log('LEN:'+('{{ outputs['emit-files'] }}').length)"
    depends_on:
      - emit-files
    group: files
output:
  pr_comment:
    format: table
    group_by: check
    collapse: true
telemetry:
  enabled: true
  sink: file
  file:
    dir: /home/buger/projects/visor-pr/tests/fixtures/temp/traces-transform
    ndjson: true
