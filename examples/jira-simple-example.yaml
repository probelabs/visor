# Simple Jira MCP Example
# Workflow: JQL Query → Pick One Issue → AI Analysis → Add Label

version: "1.0"

ai_provider: anthropic
ai_model: claude-3-sonnet

# Jira MCP Server
ai_mcp_servers:
  jira:
    command: "npx"
    args: ["-y", "@aashari/mcp-server-atlassian-jira"]
    env:
      JIRA_BASE_URL: "${JIRA_BASE_URL}"      # https://company.atlassian.net
      JIRA_EMAIL: "${JIRA_EMAIL}"            # user@company.com
      JIRA_API_TOKEN: "${JIRA_API_TOKEN}"    # your_api_token

checks:
  jira_analyze_and_label:
    type: ai
    prompt: |
      Perform this exact Jira workflow:

      1. **Query Issues**: Use JQL "project = DEV AND status = 'To Do' AND priority = High ORDER BY created DESC" to find high-priority todo items

      2. **Pick First Issue**: Select the first (most recently created) issue from the results

      3. **AI Analysis**: Analyze the selected issue for:
         - Technical complexity (1-10 scale)
         - Implementation risk (Low/Medium/High)
         - Estimated effort in story points (1,2,3,5,8)
         - Required skills/expertise

      4. **Add Label**: Based on analysis, add ONE of these labels:
         - "quick-win" (complexity ≤ 3, low risk)
         - "standard-task" (complexity 4-6, low-medium risk)
         - "complex-work" (complexity ≥ 7 or high risk)

      5. **Report**: Output the issue key, analysis summary, and label added.

      Use the Jira MCP tools to execute each step. Be concise but thorough.

    on: ["manual"]
    tags: ["jira", "simple"]

# Environment setup required:
# export JIRA_BASE_URL="https://your-company.atlassian.net"
# export JIRA_EMAIL="your.email@company.com"
# export JIRA_API_TOKEN="your_api_token"
# export ANTHROPIC_API_KEY="your_anthropic_key"

output:
  markdown:
    enabled: true
    file: "./jira-analysis.md"