# Simple example using a reusable workflow
version: "1.0"

# Import the workflow
imports:
  - ./workflows/pr-validation.yaml

# Use the imported workflow
steps:
  validate_pr:
    type: workflow
    workflow: pr-validation
    args:
      min_coverage: 75        # Override default of 80
      max_complexity: 15       # Override default of 10
      file_patterns:
        - "src/**/*.ts"
        - "src/**/*.js"
    on: [pr_opened, pr_updated]
    group: validation

  # You can use the workflow multiple times with different args
  strict_validation:
    type: workflow
    workflow: pr-validation
    args:
      min_coverage: 90        # Stricter coverage requirement
      max_complexity: 5        # Lower complexity threshold
      file_patterns:
        - "src/core/**/*.ts"  # Only core files
    on: [pr_opened]
    command: strict          # Triggered by /strict command
    group: validation

  # Use workflow outputs in other checks
  final_decision:
    type: script
    content: |
      const prValidation = outputs.validate_pr;
      if (!prValidation.passed) {
        return {
          decision: "blocked",
          reason: prValidation.report
        };
      }
      return {
        decision: "approved",
        message: "All validation checks passed"
      };
    depends_on: [validate_pr]
    group: decision

# Output configuration
output:
  pr_comment:
    format: markdown
    group_by: group
    collapse: true