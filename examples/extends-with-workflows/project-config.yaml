# Project-specific configuration extending base
version: "1.0"

# Extend base configuration (using extends)
extends: ./base-config.yaml

# Add project-specific workflow imports
imports:
  - ./workflows/project-validation.yaml

# Override and add steps
steps:
  # Override the default security check with stricter settings
  default_security:
    type: workflow
    workflow: security-scan
    args:
      severity_threshold: high  # Stricter than base
      scan_dependencies: true
      custom_patterns:
        - "Check for API key exposure"
        - "Validate JWT implementation"
    on: [pr_opened, pr_updated, manual]  # Added manual trigger
    group: security

  # Keep default_quality as is (inherited from base)

  # Add new project-specific check
  project_validation:
    type: workflow
    workflow: project-validation
    args:
      strict_mode: true
      check_tests: true
    on: [pr_opened, pr_updated]
    group: validation

  # Add a final review that depends on all checks
  comprehensive_review:
    type: ai
    prompt: |
      Review the results from all workflow checks:

      Security: {{ outputs.default_security }}
      Quality: {{ outputs.default_quality }}
      Validation: {{ outputs.project_validation }}

      Provide a final assessment.
    depends_on: [default_security, default_quality, project_validation]
    on: [pr_opened, pr_updated]
    group: summary

# Override output settings
output:
  pr_comment:
    format: markdown
    group_by: group
    collapse: true  # Changed from base config