version: "1.0"

# Reusable Tools Library
# This file defines custom tools that can be imported and reused across multiple configurations.

tools:
  fetch-jira-issue:
    name: fetch-jira-issue
    description: Fetch JIRA issue details by issue key
    inputSchema:
      type: object
      properties:
        issue_key:
          type: string
          description: JIRA issue key (e.g., PROJ-123)
      required: [issue_key]
    exec: |
      # In production, this would call JIRA API
      # For demo, we simulate fetching issue data
      ISSUE_KEY="{{ args.issue_key }}"
      echo "{
        \"key\": \"$ISSUE_KEY\",
        \"summary\": \"Example issue for $ISSUE_KEY\",
        \"priority\": \"high\",
        \"assignee\": \"alice\",
        \"status\": \"in-progress\"
      }"
    parseJson: true
    timeout: 5000

  fetch-external-data:
    name: fetch-external-data
    description: Fetch data from various external sources
    inputSchema:
      type: object
      properties:
        source:
          type: string
          description: Data source identifier
        format:
          type: string
          enum: [json, xml, text]
          default: json
      required: [source]
    exec: |
      SOURCE="{{ args.source }}"
      FORMAT="{{ args.format }}"

      case $SOURCE in
        "user-db")
          echo '{"source":"user-db","data":{"users":["alice","bob"],"count":2}}'
          ;;
        "config-service")
          echo '{"source":"config-service","data":{"environment":"production","version":"1.2.3"}}'
          ;;
        "metrics-api")
          echo '{"source":"metrics-api","data":{"cpu":45,"memory":78,"requests":1523}}'
          ;;
        *)
          echo '{"source":"'$SOURCE'","data":"mock-data","format":"'$FORMAT'"}'
          ;;
      esac
    parseJson: true
    timeout: 5000

  validate-data:
    name: validate-data
    description: Validate data against rules
    inputSchema:
      type: object
      properties:
        data:
          type: object
          description: Data to validate
        rules:
          type: array
          description: Validation rules
      required: [data]
    exec: |
      # Simple validation check
      DATA='{{ args.data | json }}'
      echo "{
        \"valid\": true,
        \"checked_at\": \"$(date -u +%Y-%m-%dT%H:%M:%SZ)\",
        \"data\": $DATA
      }"
    parseJson: true
    timeout: 2000

# This file is meant to be imported via "extends:" in other configurations.
# No steps are defined here - only reusable tools.
steps: {}
