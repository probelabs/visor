# üîí Security Analysis Report

{% if issues.size == 0 %}
## ‚úÖ No Security Issues Found

Great job! This code review found no security vulnerabilities in the analyzed files.

{% else %}

## üìä Security Summary

Found **{{ issues.size }}** security issue{% if issues.size > 1 %}s{% endif %} requiring attention:

{% assign critical_count = issues | where: "severity", "critical" | size %}
{% assign error_count = issues | where: "severity", "error" | size %}
{% assign warning_count = issues | where: "severity", "warning" | size %}
{% assign info_count = issues | where: "severity", "info" | size %}

| Severity | Count |
|----------|-------|
| üî¥ Critical | {{ critical_count }} |
| üü† Error | {{ error_count }} |
| üü° Warning | {{ warning_count }} |
| üîµ Info | {{ info_count }} |

---

{% if critical_count > 0 %}
## üö® Critical Security Issues

{% for issue in issues %}
{% if issue.severity == "critical" %}
### {{ issue.ruleId }}
**File**: `{{ issue.file }}:{{ issue.line }}`

{{ issue.message }}

{% if issue.suggestion %}
**üí° Recommended Fix**: {{ issue.suggestion }}
{% endif %}

---
{% endif %}
{% endfor %}
{% endif %}

{% if error_count > 0 %}
## ‚ùå Security Errors  

{% for issue in issues %}
{% if issue.severity == "error" %}
### {{ issue.ruleId }}
**File**: `{{ issue.file }}:{{ issue.line }}`

{{ issue.message }}

{% if issue.suggestion %}
**üí° Recommended Fix**: {{ issue.suggestion }}
{% endif %}

---
{% endif %}
{% endfor %}
{% endif %}

{% if warning_count > 0 %}
## ‚ö†Ô∏è Security Warnings

<details>
<summary>View {{ warning_count }} warning{% if warning_count > 1 %}s{% endif %}</summary>

{% for issue in issues %}
{% if issue.severity == "warning" %}
### {{ issue.ruleId }}
**File**: `{{ issue.file }}:{{ issue.line }}`

{{ issue.message }}

{% if issue.suggestion %}
**üí° Recommended Fix**: {{ issue.suggestion }}
{% endif %}

---
{% endif %}
{% endfor %}

</details>
{% endif %}

{% if info_count > 0 %}
## ‚ÑπÔ∏è Security Information

<details>
<summary>View {{ info_count }} informational item{% if info_count > 1 %}s{% endif %}</summary>

{% for issue in issues %}
{% if issue.severity == "info" %}
### {{ issue.ruleId }}
**File**: `{{ issue.file }}:{{ issue.line }}`

{{ issue.message }}

{% if issue.suggestion %}
**üí° Suggested Improvement**: {{ issue.suggestion }}
{% endif %}

---
{% endif %}
{% endfor %}

</details>
{% endif %}

{% endif %}

## üõ°Ô∏è Security Best Practices

{% if suggestions.size > 0 %}
Based on this analysis, consider these recommendations:

{% for suggestion in suggestions %}
- {{ suggestion }}
{% endfor %}
{% endif %}

### General Security Reminders:
- Always validate and sanitize user input
- Use parameterized queries to prevent SQL injection  
- Implement proper authentication and authorization
- Keep dependencies updated to patch known vulnerabilities
- Follow the principle of least privilege
- Use HTTPS for all data transmission
- Implement proper error handling without information disclosure

---

*ü§ñ Generated by Visor Security Analysis*